
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schedule Appointment</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex items-center justify-center min-h-screen bg-gray-100">
    <div class="bg-white p-8 shadow-lg rounded-lg w-96">
        <h2 class="text-2xl font-bold text-center text-gray-700 mb-6">Schedule an Appointment</h2>

        <form id="appointment-form" class="space-y-4">
            <input type="date" id="date-picker" name="date" class="w-full p-2 border border-gray-300 rounded" required>
            <input type="time" id="time-picker" name="time" class="w-full p-2 border border-gray-300 rounded" required>
            <input type="hidden" id="latitude" name="latitude">
            <input type="hidden" id="longitude" name="longitude">
            <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600 transition">Submit</button>
        </form>

        <div class="mt-6">
            <h3 class="text-lg font-semibold text-gray-700">Saved Appointments:</h3>
            <ul id="appointments-list" class="mt-2 text-gray-600"></ul>
        </div>
    </div>

    <script>
        document.getElementById("appointment-form").addEventListener("submit", async function(event) {
            event.preventDefault();

            let formData = new FormData(this);

            let response = await fetch("/submit_appointment", {
                method: "POST",
                body: formData
            });

            let result = await response.json();
            alert(result.message);
            loadAppointments();
        });

        async function loadAppointments() {
            let response = await fetch("/appointments");
            let appointments = await response.json();
            let list = document.getElementById("appointments-list");
            list.innerHTML = "";
            appointments.forEach(appointment => {
                let li = document.createElement("li");
                li.textContent = `${appointment.date} at ${appointment.time} (Lat: ${appointment.latitude}, Lng: ${appointment.longitude})`;
                list.appendChild(li);
            });
        }

        loadAppointments();
    </script>
</body>
</html>